<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- 基础SEO -->
  <title>智衡权重确定平台 - 大语言模型驱动的权重方法推荐系统 | 厦门大学数据挖掘研究中心</title>
  <meta name="description" content="智衡权重确定平台是厦门大学数据挖掘研究中心开发的AI驱动权重方法推荐系统，通过三代理协作和混合推荐引擎，为统计分析项目智能推荐最适合的权重计算方法。支持AHP、熵权法、CRITIC等9种主流方法。">
  <meta name="keywords" content="权重方法推荐,统计权重,权重确定,大语言模型,AI推荐系统,层次分析法,熵权法,CRITIC,数据挖掘,厦门大学,决策分析,多准则评价">
  <meta name="author" content="厦门大学数据挖掘研究中心">
  <meta name="robots" content="index, follow">
  <meta name="language" content="zh-CN">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://your-project-url.vercel.app/">
  <meta property="og:title" content="智衡权重确定平台 - 大语言模型驱动的权重方法推荐系统">
  <meta property="og:description" content="AI驱动的权重方法推荐系统，通过三代理协作智能推荐最适合的统计权重计算方法。厦门大学数据挖掘研究中心官方开发。">
  <meta property="og:image" content="https://your-project-url.vercel.app/微信图片_20230714090909.jpg">
  <meta property="og:site_name" content="智衡权重确定平台">
  <meta property="og:locale" content="zh_CN">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://your-project-url.vercel.app/">
  <meta property="twitter:title" content="智衡权重确定平台 - 大语言模型驱动的权重方法推荐系统">
  <meta property="twitter:description" content="AI驱动的权重方法推荐系统，通过三代理协作智能推荐最适合的统计权重计算方法。厦门大学数据挖掘研究中心官方开发。">
  <meta property="twitter:image" content="https://your-project-url.vercel.app/微信图片_20230714090909.jpg">
  
  <!-- 学术相关 -->
  <meta name="citation_title" content="智衡权重确定平台: 大语言模型驱动的权重方法推荐系统">
  <meta name="citation_author" content="厦门大学数据挖掘研究中心">
  <meta name="citation_publication_date" content="2025">
  <meta name="citation_online_date" content="2025">
  <meta name="citation_language" content="zh">
  
  <!-- 技术相关 -->
  <meta name="application-name" content="智衡权重确定平台">
  <meta name="msapplication-TileColor" content="#007AFF">
  <meta name="theme-color" content="#007AFF">
  
  <!-- 预加载关键资源 -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://api.deepseek.com">
  
  <!-- 样式表 -->
  <link rel="stylesheet" href="home-style.css">
  
  <!-- 结构化数据 -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "智衡权重确定平台",
    "description": "大语言模型驱动的权重方法推荐系统",
    "url": "https://your-project-url.vercel.app",
    "author": {
      "@type": "Organization",
      "name": "厦门大学数据挖掘研究中心",
      "url": "https://xdmrc.org"
    },
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "CNY"
    }
  }
  </script>
</head>
<body>
  <div class="container">
    <!-- Header Section -->
    <header class="header">
      <div class="header-content">
        <div class="logo-section">
          <img src="微信图片_20230714090909.jpg" alt="厦门大学数据挖掘研究中心" class="logo">
          <div class="title-group">
            <h1 class="main-title">智衡权重确定平台</h1>
            <p class="subtitle">Zhiheng Weight Determination Platform</p>
          </div>
        </div>
        
        <!-- Navigation Menu -->
        <nav class="header-nav">
          <ul class="nav-menu">
            <li><a href="#modules" class="nav-link">功能介绍</a></li>
            <li><a href="#about" class="nav-link">关于我们</a></li>
            <li><a href="#contact" class="nav-link">联系我们</a></li>
            <li>
              <button id="apiConfigToggle" class="api-config-btn">
                <span class="api-config-text">API配置</span>
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <!-- API Key Panel (移出模块区域) -->
    <div id="apiKeyManagerPanel" class="api-key-panel">
      <div class="api-key-panel-header">
        <h4>API配置</h4>
        <button class="api-key-close" id="apiKeyPanelClose">&times;</button>
      </div>
      
      <div class="api-key-panel-content">
        <div class="model-selection">
          <h5>选择LLM模型</h5>
          <div class="model-options">
            <label class="model-option">
              <input type="radio" name="modelType" value="deepseek" checked>
              <span class="model-icon">🧠</span>
              <span class="model-name">Deepseek</span>
            </label>
            <label class="model-option">
              <input type="radio" name="modelType" value="openai">
              <span class="model-icon">🤖</span>
              <span class="model-name">ChatGPT</span>
            </label>
            <label class="model-option">
              <input type="radio" name="modelType" value="qwen">
              <span class="model-icon">🔮</span>
              <span class="model-name">通义千问</span>
            </label>
          </div>
        </div>
        
        <!-- Deepseek API Keys -->
        <div class="api-keys-section" id="deepseekApiKeys">
          <h5>Deepseek API密钥设置</h5>
          <p class="api-key-info">系统已配置Deepseek API密钥，您也可以使用自己的密钥</p>
          <p class="api-key-warning" style="color: #e74c3c; font-weight: bold;">重要提示：系统使用并行调用机制，必须配置全部三个API密钥以获得最佳性能</p>
          
          <div class="api-key-inputs">
            <div class="api-key-input-group">
              <label>主要API密钥:</label>
              <input type="password" id="deepseek_api_key" placeholder="sk-..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 1:</label>
              <input type="password" id="deepseek_api_key_api2" placeholder="sk-..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 2:</label>
              <input type="password" id="deepseek_api_key_api3" placeholder="sk-..." autocomplete="off">
            </div>
          </div>
        </div>
        
        <!-- OpenAI API Keys -->
        <div class="api-keys-section" id="openaiApiKeys" style="display: none;">
          <h5>OpenAI API密钥设置</h5>
          <p class="api-key-info">系统已配置Deepseek API密钥，您也可以使用自己的ChatGPT密钥</p>
          <p class="api-key-warning" style="color: #e74c3c; font-weight: bold;">重要提示：系统使用并行调用机制，必须配置全部三个API密钥以获得最佳性能</p>
          
          <div class="api-key-inputs">
            <div class="api-key-input-group">
              <label>主要API密钥:</label>
              <input type="password" id="openai_api_key" placeholder="sk-..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 1:</label>
              <input type="password" id="openai_api_key_api2" placeholder="sk-..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 2:</label>
              <input type="password" id="openai_api_key_api3" placeholder="sk-..." autocomplete="off">
            </div>
          </div>
        </div>
        
        <!-- Qwen API Keys -->
        <div class="api-keys-section" id="qwenApiKeys" style="display: none;">
          <h5>通义千问API密钥设置</h5>
          <p class="api-key-info">系统已配置Deepseek API密钥，您也可以使用自己的通义千问密钥</p>
          <p class="api-key-warning" style="color: #e74c3c; font-weight: bold;">重要提示：系统使用并行调用机制，必须配置全部三个API密钥以获得最佳性能</p>
          
          <div class="api-key-inputs">
            <div class="api-key-input-group">
              <label>主要API密钥:</label>
              <input type="password" id="qwen_api_key" placeholder="..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 1:</label>
              <input type="password" id="qwen_api_key_api2" placeholder="..." autocomplete="off">
            </div>
            <div class="api-key-input-group">
              <label>备用API密钥 2:</label>
              <input type="password" id="qwen_api_key_api3" placeholder="..." autocomplete="off">
            </div>
          </div>
        </div>
        
        <div class="api-key-actions">
          <button class="btn-primary" id="saveApiKeys">保存密钥</button>
          <button class="btn-secondary" id="clearApiKeys">清除密钥</button>
        </div>
        
        <div class="api-key-status" id="apiKeyStatus"></div>
      </div>
    </div>
    
    <!-- 添加背景遮罩用于点击关闭 -->
    <div id="apiKeyBackdrop" class="api-key-backdrop"></div>

    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h2 class="hero-title">智能化权重确定解决方案</h2>
        <p class="hero-description">
          基于人工智能技术，为您的统计分析项目推荐最适合的权重计算方法。
          简化复杂的权重确定过程，提升决策分析的科学性和准确性。
        </p>
      </div>
    </section>

    <!-- Modules Section -->
    <section id="modules" class="modules">
      <div class="modules-header">
        <div class="modules-text">
          <h3>平台功能模块</h3>
          <p>大语言模型驱动的权重确定全流程解决方案，涵盖从方法推荐到结果可视化的完整流程</p>
        </div>
      </div>
      
      <div class="modules-grid">
        <!-- Module 1: Available -->
        <div class="module-card available" onclick="navigateToQuestionnaire()">
          <div class="module-header">
            <div class="module-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="module-status available">可用</div>
          </div>
          <h4 class="module-title">权重方法推荐</h4>
          <p class="module-description">
            基于AI分析用户需求和数据特征，智能推荐最适合的权重计算方法。
            支持主观、客观、组合等20多主流方法。
          </p>
          <div class="module-features">
            <span class="feature-tag">智能推荐</span>
            <span class="feature-tag">多方法支持</span>
            <span class="feature-tag">详细说明</span>
          </div>
          <div class="module-action">
            <button class="btn-primary">立即使用</button>
          </div>
        </div>

        <!-- Module 2: Coming Soon -->
        <div class="module-card coming-soon">
          <div class="module-header">
            <div class="module-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="module-status beta">内测中</div>
          </div>
          <h4 class="module-title">权重计算</h4>
          <p class="module-description">
            根据推荐的方法，自动计算各指标权重值。
            支持批量数据处理和多种数据格式输入。
          </p>
          <div class="module-features">
            <span class="feature-tag">自动计算</span>
            <span class="feature-tag">批量处理</span>
            <span class="feature-tag">多格式支持</span>
          </div>
          <div class="module-action">
            <button class="btn-secondary" disabled>敬请期待</button>
          </div>
        </div>

        <!-- Module 3: Coming Soon -->
        <div class="module-card coming-soon">
          <div class="module-header">
            <div class="module-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="module-status beta">内测中</div>
          </div>
          <h4 class="module-title">自定义方法计算</h4>
          <p class="module-description">
            支持用户自定义权重计算方法，满足特殊场景需求。
            提供可视化编程界面，无需编程基础。
          </p>
          <div class="module-features">
            <span class="feature-tag">自定义算法</span>
            <span class="feature-tag">可视化编程</span>
            <span class="feature-tag">灵活配置</span>
          </div>
          <div class="module-action">
            <button class="btn-secondary" disabled>敬请期待</button>
          </div>
        </div>

        <!-- Module 4: Coming Soon -->
        <div class="module-card coming-soon">
          <div class="module-header">
            <div class="module-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="module-status beta">内测中</div>
          </div>
          <h4 class="module-title">结果解释与可视化</h4>
          <p class="module-description">
            生成权重计算结果的详细解释报告，提供多种可视化图表。
            帮助理解权重分布和影响因素。
          </p>
          <div class="module-features">
            <span class="feature-tag">智能解释</span>
            <span class="feature-tag">多种图表</span>
            <span class="feature-tag">报告导出</span>
          </div>
          <div class="module-action">
            <button class="btn-secondary" disabled>敬请期待</button>
          </div>
        </div>
      </div>
    </section>
  <!-- Features Section -->
  <section class="features">
    <div class="features-content">
      <h3>为什么选择智衡平台？</h3>
      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">🤖</div>
          <h4>AI智能推荐</h4>
          <p>基于大语言模型，智能分析用户需求与数据特征，推荐最适合的权重方法</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">🎓</div>
          <h4>学术权威</h4>
          <p>厦门大学数据挖掘研究中心开发，确保方法的科学性和可靠性</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">🚀</div>
          <h4>简单易用</h4>
          <p>直观的用户界面，无需专业知识，快速获得权重计算方案</p>
        </div>
        <div class="feature-item">
          <div class="feature-icon">📈</div>
          <h4>全面覆盖</h4>
          <p>支持20+种主流权重方法，覆盖各种应用场景和数据类型</p>
        </div>
      </div>
    </div>
  </section>

    <!-- About Section -->
    <section id="about" class="about">
      <div class="about-content">
        <div class="about-header">
          <h3>关于厦门大学数据挖掘研究中心</h3>
          <p class="about-subtitle">自2006年成立以来，致力于数据科学理论创新与实践应用</p>
        </div>
        
        <div class="about-preview">
          <div class="preview-stats">
            <div class="stat-item">
              <div class="stat-number">19+</div>
              <div class="stat-label">年发展历程</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">150+</div>
              <div class="stat-label">学术论文</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">50+</div>
              <div class="stat-label">师资力量</div>
            </div>
          </div>
          
          <div class="preview-text">
            <p>厦门大学数据挖掘研究中心成立于2006年，2010年正式成立为校直属教学科研机构。中心充分发挥学科交叉优势，整合统计学、计量经济学、数量经济学、信息管理学等相关学科，是跨学科、综合型、开放式的教学研究机构。</p>
            <div class="preview-action">
              <a href="about.html" class="btn-about">了解更多 →</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
      <div class="contact-content">
        <h3>联系我们</h3>
        <div class="contact-grid">
          <div class="contact-item">
            <div class="contact-icon">📧</div>
            <h4>问题反馈</h4>
            <p><a href="mailto:ruanweiqiao@stu.xmu.edu.cn">ruanweiqiao@stu.xmu.edu.cn</a></p>
            <p class="contact-desc">技术支持与问题反馈</p>
          </div>
          <div class="contact-item">
            <div class="contact-icon">🌐</div>
            <h4>官方网站</h4>
            <p><a href="http://www.dmrc.work" target="_blank">www.dmrc.work</a></p>
            <p class="contact-desc">更多研究成果与学术资讯</p>
          </div>
          <div class="contact-item">
            <div class="contact-icon">📍</div>
            <h4>研究中心</h4>
            <p>厦门大学思明校区</p>
            <p class="contact-desc">福建省厦门市思明区</p>
          </div>
        </div>
      </div>
    </section>

    
    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 厦门大学数据挖掘研究中心. All rights reserved.</p>
        <p>Xiamen University Data-Mining Research Center</p>
      </div>
    </footer>
  </div>

  <script>
    function navigateToQuestionnaire() {
      window.location.href = 'methomath.html';
    }

    // Add smooth scroll behavior and navigation
    document.addEventListener('DOMContentLoaded', function() {
      // Smooth scroll for navigation links
      document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').substring(1);
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
      // Add hover effects to module cards
      const moduleCards = document.querySelectorAll('.module-card');
      moduleCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-8px)';
        });
        card.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0)';
        });
      });

      // Add fade-in animation on scroll
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      }, observerOptions);

      // Observe elements for animation
      document.querySelectorAll('.module-card, .feature-item').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
      });
      
      // API Key Manager
      const apiKeyToggle = document.getElementById('apiConfigToggle');
      const apiKeyPanel = document.getElementById('apiKeyManagerPanel');
      const apiKeyClose = document.getElementById('apiKeyPanelClose');
      const apiKeyBackdrop = document.getElementById('apiKeyBackdrop');
      const saveApiKeysBtn = document.getElementById('saveApiKeys');
      const clearApiKeysBtn = document.getElementById('clearApiKeys');
      const apiKeyStatus = document.getElementById('apiKeyStatus');
      const modelOptions = document.querySelectorAll('input[name="modelType"]');
      
      // 初始化当前模型类型
      const currentModelType = localStorage.getItem('current_model_type') || 'deepseek';
      document.querySelector(`input[name="modelType"][value="${currentModelType}"]`).checked = true;
      showApiKeysSection(currentModelType);
      
      // 加载已保存的API密钥
      loadSavedApiKeys();
      
      // 显示/隐藏API密钥面板
      apiKeyToggle.addEventListener('click', function() {
        apiKeyPanel.classList.add('show');
        apiKeyBackdrop.classList.add('show');
        document.body.style.overflow = 'hidden'; // 防止背景滚动
      });
      
      // 关闭API密钥面板
      apiKeyClose.addEventListener('click', function() {
        closeApiKeyPanel();
      });
      
      // 点击背景关闭面板
      apiKeyBackdrop.addEventListener('click', function() {
        closeApiKeyPanel();
      });
      
      // 关闭API密钥面板的函数
      function closeApiKeyPanel() {
        apiKeyPanel.classList.remove('show');
        apiKeyBackdrop.classList.remove('show');
        document.body.style.overflow = ''; // 恢复背景滚动
      }
      
      // ESC键关闭面板
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && apiKeyPanel.classList.contains('show')) {
          closeApiKeyPanel();
        }
      });
      
      // 切换模型类型
      modelOptions.forEach(option => {
        option.addEventListener('change', function() {
          const modelType = this.value;
          showApiKeysSection(modelType);
          localStorage.setItem('current_model_type', modelType);
        });
      });
      
      // 保存API密钥
      saveApiKeysBtn.addEventListener('click', function() {
        const modelType = document.querySelector('input[name="modelType"]:checked').value;
        
        switch(modelType) {
          case 'deepseek':
            saveDeepseekApiKeys();
            break;
          case 'openai':
            saveOpenaiApiKey();
            break;
          case 'qwen':
            saveQwenApiKey();
            break;
        }
      });
      
      // 检查API密钥完整性
      function checkApiKeysCompleteness(modelType) {
        let mainKey, key2, key3;
        let modelName;
        
        switch(modelType) {
          case 'deepseek':
            mainKey = localStorage.getItem('deepseek_api_key');
            key2 = localStorage.getItem('deepseek_api_key_api2');
            key3 = localStorage.getItem('deepseek_api_key_api3');
            modelName = 'Deepseek';
            break;
          case 'openai':
            mainKey = localStorage.getItem('openai_api_key');
            key2 = localStorage.getItem('openai_api_key_api2');
            key3 = localStorage.getItem('openai_api_key_api3');
            modelName = 'OpenAI';
            break;
          case 'qwen':
            mainKey = localStorage.getItem('qwen_api_key');
            key2 = localStorage.getItem('qwen_api_key_api2');
            key3 = localStorage.getItem('qwen_api_key_api3');
            modelName = '通义千问';
            break;
        }
        
        // 检查是否配置了所有三个API密钥
        if (mainKey && key2 && key3) {
          showStatus(`已成功配置所有${modelName}的API密钥，系统将使用并行调用以获得最佳性能`, 'success');
          setTimeout(closeApiKeyPanel, 2000); // 成功配置后2秒自动关闭面板
        } else if (mainKey || key2 || key3) {
          const configuredCount = [mainKey, key2, key3].filter(Boolean).length;
          showStatus(`已配置${configuredCount}/3个${modelName}的API密钥。必须配置全部三个API密钥以获得最佳性能`, 'warning');
        } else {
          showStatus('未提供任何API密钥', 'error');
        }
      }
      
      // 清除API密钥
      clearApiKeysBtn.addEventListener('click', function() {
        const modelType = document.querySelector('input[name="modelType"]:checked').value;
        
        switch(modelType) {
          case 'deepseek':
            document.getElementById('deepseek_api_key').value = '';
            document.getElementById('deepseek_api_key_api2').value = '';
            document.getElementById('deepseek_api_key_api3').value = '';
            localStorage.removeItem('deepseek_api_key');
            localStorage.removeItem('deepseek_api_key_api2');
            localStorage.removeItem('deepseek_api_key_api3');
            break;
          case 'openai':
            document.getElementById('openai_api_key').value = '';
            document.getElementById('openai_api_key_api2').value = '';
            document.getElementById('openai_api_key_api3').value = '';
            localStorage.removeItem('openai_api_key');
            localStorage.removeItem('openai_api_key_api2');
            localStorage.removeItem('openai_api_key_api3');
            break;
          case 'qwen':
            document.getElementById('qwen_api_key').value = '';
            document.getElementById('qwen_api_key_api2').value = '';
            document.getElementById('qwen_api_key_api3').value = '';
            localStorage.removeItem('qwen_api_key');
            localStorage.removeItem('qwen_api_key_api2');
            localStorage.removeItem('qwen_api_key_api3');
            break;
        }
        
        showStatus('API密钥已清除', 'success');
      });
      
      // 显示对应模型的API密钥输入区域
      function showApiKeysSection(modelType) {
        document.getElementById('deepseekApiKeys').style.display = modelType === 'deepseek' ? 'block' : 'none';
        document.getElementById('openaiApiKeys').style.display = modelType === 'openai' ? 'block' : 'none';
        document.getElementById('qwenApiKeys').style.display = modelType === 'qwen' ? 'block' : 'none';
      }
      
      // 加载已保存的API密钥
      function loadSavedApiKeys() {
        // Deepseek
        const deepseekApiKey = localStorage.getItem('deepseek_api_key');
        if (deepseekApiKey) {
          document.getElementById('deepseek_api_key').value = deepseekApiKey;
        }
        
        const deepseekApiKey2 = localStorage.getItem('deepseek_api_key_api2');
        if (deepseekApiKey2) {
          document.getElementById('deepseek_api_key_api2').value = deepseekApiKey2;
        }
        
        const deepseekApiKey3 = localStorage.getItem('deepseek_api_key_api3');
        if (deepseekApiKey3) {
          document.getElementById('deepseek_api_key_api3').value = deepseekApiKey3;
        }
        
        // OpenAI
        const openaiApiKey = localStorage.getItem('openai_api_key');
        if (openaiApiKey) {
          document.getElementById('openai_api_key').value = openaiApiKey;
        }
        
        const openaiApiKey2 = localStorage.getItem('openai_api_key_api2');
        if (openaiApiKey2) {
          document.getElementById('openai_api_key_api2').value = openaiApiKey2;
        }
        
        const openaiApiKey3 = localStorage.getItem('openai_api_key_api3');
        if (openaiApiKey3) {
          document.getElementById('openai_api_key_api3').value = openaiApiKey3;
        }
        
        // Qwen
        const qwenApiKey = localStorage.getItem('qwen_api_key');
        if (qwenApiKey) {
          document.getElementById('qwen_api_key').value = qwenApiKey;
        }
        
        const qwenApiKey2 = localStorage.getItem('qwen_api_key_api2');
        if (qwenApiKey2) {
          document.getElementById('qwen_api_key_api2').value = qwenApiKey2;
        }
        
        const qwenApiKey3 = localStorage.getItem('qwen_api_key_api3');
        if (qwenApiKey3) {
          document.getElementById('qwen_api_key_api3').value = qwenApiKey3;
        }
        
        // 检查当前选择模型的API密钥完整性
        const currentModelType = localStorage.getItem('current_model_type') || 'deepseek';
        checkApiKeysCompleteness(currentModelType);
      }
      
      // 保存Deepseek API密钥
      function saveDeepseekApiKeys() {
        const mainApiKey = document.getElementById('deepseek_api_key').value.trim();
        const apiKey2 = document.getElementById('deepseek_api_key_api2').value.trim();
        const apiKey3 = document.getElementById('deepseek_api_key_api3').value.trim();
        
        // 检查是否所有三个密钥都已填写
        if (!mainApiKey || !apiKey2 || !apiKey3) {
          showStatus('请填写所有三个API密钥以确保系统正常运行', 'error');
          return;
        }
        
        if (validateApiKey(mainApiKey, 'deepseek') && 
            validateApiKey(apiKey2, 'deepseek') && 
            validateApiKey(apiKey3, 'deepseek')) {
          
          localStorage.setItem('deepseek_api_key', mainApiKey);
          localStorage.setItem('deepseek_api_key_api2', apiKey2);
          localStorage.setItem('deepseek_api_key_api3', apiKey3);
          
          showStatus('已成功保存所有Deepseek API密钥', 'success');
          setTimeout(closeApiKeyPanel, 2000); // 成功配置后2秒自动关闭面板
        } else {
          showStatus('一个或多个API密钥格式不正确', 'error');
        }
      }
      
      // 保存OpenAI API密钥
      function saveOpenaiApiKey() {
        const mainApiKey = document.getElementById('openai_api_key').value.trim();
        const apiKey2 = document.getElementById('openai_api_key_api2').value.trim();
        const apiKey3 = document.getElementById('openai_api_key_api3').value.trim();
        
        // 检查是否所有三个密钥都已填写
        if (!mainApiKey || !apiKey2 || !apiKey3) {
          showStatus('请填写所有三个API密钥以确保系统正常运行', 'error');
          return;
        }
        
        if (validateApiKey(mainApiKey, 'openai') && 
            validateApiKey(apiKey2, 'openai') && 
            validateApiKey(apiKey3, 'openai')) {
          
          localStorage.setItem('openai_api_key', mainApiKey);
          localStorage.setItem('openai_api_key_api2', apiKey2);
          localStorage.setItem('openai_api_key_api3', apiKey3);
          
          showStatus('已成功保存所有OpenAI API密钥', 'success');
          setTimeout(closeApiKeyPanel, 2000); // 成功配置后2秒自动关闭面板
        } else {
          showStatus('一个或多个API密钥格式不正确', 'error');
        }
      }
      
      // 保存通义千问API密钥
      function saveQwenApiKey() {
        const mainApiKey = document.getElementById('qwen_api_key').value.trim();
        const apiKey2 = document.getElementById('qwen_api_key_api2').value.trim();
        const apiKey3 = document.getElementById('qwen_api_key_api3').value.trim();
        
        // 检查是否所有三个密钥都已填写
        if (!mainApiKey || !apiKey2 || !apiKey3) {
          showStatus('请填写所有三个API密钥以确保系统正常运行', 'error');
          return;
        }
        
        if (validateApiKey(mainApiKey, 'qwen') && 
            validateApiKey(apiKey2, 'qwen') && 
            validateApiKey(apiKey3, 'qwen')) {
          
          localStorage.setItem('qwen_api_key', mainApiKey);
          localStorage.setItem('qwen_api_key_api2', apiKey2);
          localStorage.setItem('qwen_api_key_api3', apiKey3);
          
          showStatus('已成功保存所有通义千问API密钥', 'success');
          setTimeout(closeApiKeyPanel, 2000); // 成功配置后2秒自动关闭面板
        } else {
          showStatus('一个或多个API密钥格式不正确', 'error');
        }
      }
      
      // 验证API密钥格式
      function validateApiKey(apiKey, modelType) {
        if (!apiKey || apiKey === "your-api-key-here") {
          return false;
        }
        
        // 放宽验证要求，使其更加友好
        switch(modelType) {
          case 'openai':
            // OpenAI密钥通常以sk-开头，但允许其他格式
            return apiKey.length >= 10;
          case 'qwen':
            // 通义千问密钥只要求一定长度
            return apiKey.length >= 10;
          case 'deepseek':
          default:
            // Deepseek密钥通常以sk-开头，但允许其他格式
            return apiKey.length >= 10;
        }
      }
      
      // 显示状态消息
      function showStatus(message, type) {
        apiKeyStatus.textContent = message;
        apiKeyStatus.className = 'api-key-status';
        apiKeyStatus.classList.add(type);
        
        // 添加样式
        if (type === 'error') {
          apiKeyStatus.style.color = '#e74c3c';
          apiKeyStatus.style.backgroundColor = '#fde8e6';
        } else if (type === 'success') {
          apiKeyStatus.style.color = '#27ae60';
          apiKeyStatus.style.backgroundColor = '#e6f9ee';
        } else if (type === 'warning') {
          apiKeyStatus.style.color = '#f39c12';
          apiKeyStatus.style.backgroundColor = '#fef5e7';
        }
        
        // 显示状态消息的时间
        const displayTime = type === 'success' ? 3000 : 6000; // 成功消息显示3秒，其他显示6秒
        
        // 自动清除状态消息
        setTimeout(() => {
          apiKeyStatus.textContent = '';
          apiKeyStatus.className = 'api-key-status';
          apiKeyStatus.style.color = '';
          apiKeyStatus.style.backgroundColor = '';
        }, displayTime);
      }
    });
  </script>
</body>
</html>